# Техническое задание

## Задача
1. Создать компонент для вывода списка пользователей в табличном виде.
Обязательные поля для отображения:
- Фамилия
- Имя
- Отчество
- Должность
- Рабочий телефон
- Фамилия начальника
- Количество подчиненных
- Статус пользователя (работает/не работает/в отпуске/отсутствует(причина)).

2. Предусмотреть постраничную навигацию и возможность выбирать количество пользователей на странице: 10, 30, 50, 100, все

3. Предусмотреть возможность перейти в профиль любого из пользователей

## Решение
Для отображения списка пользователей будем использовать компонент "bitrix:main.ui.grid". Он уже включает в себя весь необходимый интерфейс.

Список пользователей будем получать с помощью класса "\Bitrix\Intranet\UserTable" это простое расширение класса "\Bitrix\Main\UserTable" которое добавляет несколько runtime полей для определения является ли пользователь сотрудником. Это нам понадобится чтобы для экстранет пользователей не искать руководителей.

Статус и текст статуса будем получать через left join таблицы "Bitrix\Im\Model\StatusTable".

Информацию о начальнике будем получать через "\CIntranetUtils::GetDepartmentManager", а количество подчиненных через  "\CIntranetUtils::getSubordinateEmployees"

Ссылку на профиль пользователя будем формировать на основе шаблона переданного в компонент, по умолчанию будем брать из параметра "search_user_url" модуля интранет.

Переход в профиль пользователя будет доступен в действиях над строкой грида. Так же по умолчанию он будет отрабатывать при двойном клике на строку.

Кеширование использовать не буду, так как получение данных тревиальное и никаких нагрузок не планируется. Получение статусов выполняется в том же запросе что и список пользователей. Список пользователей выполняется без дополнительных фильтров так что работает быстро. Определение начальника и подчиненных работает через утилиты модуля интранет и подвержено внутреннему кешированию.

В случае если запросы были бы тяжелыми и нам надо было бы их кешировать можно было бы делать это следующим образом. Настроить тегированный кеш на получение списка сотрудников, всем сотрудникам по умолчанию устанавливается статус "не работает". Далее для полученных сотрудников получить их начальника и подчиненных. С помощью автокеширования закешировать подключение шаблона компонента с полученными данными. Далее в component_epilog.php с помощью JavaScript и Ajax получить информацию по статусам пользователей и заменить ее в таблице.

## Оценка
1. Сделать болванку компонента, со всеми нужными файлами, с описанием и параметрами компонента. (30 минут)

2. Выбрать из базы данных пользователей и все необходимые для формирования списка данные. (1 час)

3. Вывести данные через компонент "bitrix:main.ui.grid" (30 минут)

4. Добавить постраничную навигацию и выбор колличества элементов на странице. (1 час)

5. Добавить логику перехода в профиль пользователя. (30 минут)
